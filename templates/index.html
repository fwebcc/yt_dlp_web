<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NAS Downloader - ç®¡ç†æ§åˆ¶å°</title>
    <link rel="stylesheet" href="../static/css/bootstrap.css">
    <script src="../static/js/socket.io.min.js"></script>
    <style>
        body { background-color: #f4f7f6; font-family: -apple-system, system-ui, sans-serif; }
        .main-container { max-width: 900px; margin-top: 30px; padding-bottom: 50px; }

        /* é¡¶éƒ¨è¾“å…¥åŒº */
        .input-card {
            border: none; border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            background: #fff; padding: 0px; margin-bottom: 15px;
        }
        .url-input { border-radius: 12px 0 0 12px; border: 2px solid #eee; height: 55px; font-size: 1.1rem; }
        .url-input:focus { border-color: #cc0000; box-shadow: none; }
        .btn-download { border-radius: 0 12px 12px 0; background: #cc0000; border: none; width: 120px; font-weight: bold; }

        /* çŠ¶æ€ä¸è¿›åº¦ */
        .status-card { border: none; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 10px; background: #fff; }
        #log-container {
            background-color: #1e1e1e; color: #d4d4d4;
            height: 180px; overflow-y: auto;
            padding: 15px; border-radius: 10px;
            font-family: 'Courier New', Courier, monospace; font-size: 13px;
        }
        .log-entry { margin-bottom: 4px; border-bottom: 1px solid #333; padding-bottom: 2px; }

        /* æ–‡ä»¶åˆ—è¡¨ */
        .file-item {
            background: #fff; border-radius: 12px; padding: 15px; margin-bottom: 10px;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 2px 5px rgba(0,0,0,0.03);
        }

        /* 1. å¼¹çª—å¯¹é½ï¼šç¡®ä¿å±…ä¸­ä¸”ä¸å¼ºåˆ¶å®½åº¦ */
        #videoModal .modal-dialog {
            display: flex;
            justify-content: center;
            align-items: center;
            max-width: 95vw;
            margin: 1.75rem auto;
        }

        /* 2. æ ¸å¿ƒå®¹å™¨ï¼šå®½åº¦è®¾ä¸º min-contentï¼Œå³ç”±è§†é¢‘å®½åº¦å†³å®š */
        #videoModal .modal-content {
            width: min-content;      /* å…³é”®ï¼šå®½åº¦æœ€å°åŒ–ï¼Œä»…ç”±è§†é¢‘å®½åº¦æ’‘å¼€ */
            min-width: 200px;        /* è®¾å®šä¸€ä¸ªæœ€å°ä¿åº•å®½åº¦ */
            background-color: rgba(0, 0, 0, 0.98);
            border: 1px solid #444;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
        }

        /* 3. è§†é¢‘æ ‡ç­¾ï¼šé«˜åº¦æ˜¯çº¢çº¿ï¼Œå®½åº¦éšé«˜åº¦è‡ªé€‚åº” */
        #mainPlayer {
            display: block;
            max-height: 80vh;        /* é«˜åº¦å å±å¹• 80% */
            width: auto;             /* å®½åº¦è‡ªåŠ¨è®¡ç®—ï¼Œä¸å†æ’‘æ»¡ 100% */
            max-width: 90vw;         /* é˜²æ­¢æ¨ªå±è§†é¢‘å¤ªå®½ */
            background-color: #000;
        }

        /* 4. æ ‡é¢˜æ ä¿®æ­£ï¼šå¼ºåˆ¶ä¸æ’‘å¼€ç›’å­å®½åº¦ */
        #videoModal .modal-header {
            width: 0;                /* ç»æ‹›ï¼šå®½åº¦è®¾ä¸º0ï¼Œé…åˆ min-width: 100% ç´§è´´è§†é¢‘ */
            min-width: 100%;         /* ä¿è¯æ ‡é¢˜æ å’Œè§†é¢‘ä¸€æ ·å®½ */
            padding: 10px 15px;
            border-bottom: 1px solid #222;
            overflow: hidden;        /* è¶…å‡ºéƒ¨åˆ†è£åˆ‡ */
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* 5. æ ‡é¢˜æ–‡å­—ï¼šé•¿æ–‡ä»¶åè‡ªåŠ¨å˜çœç•¥å·ï¼Œä¸è®¸æŠŠç›’å­é¡¶å®½ */
        #videoTitle {
            color: #fff;
            white-space: nowrap;     /* å¼ºåˆ¶ä¸æ¢è¡Œ */
            overflow: hidden;        /* è¶…å‡ºéšè— */
            text-overflow: ellipsis; /* æ˜¾ç¤ºçœç•¥å· ... */
            margin: 0;
            font-size: 0.95rem;
            flex: 1;                 /* å æ®å‰©ä½™ç©ºé—´ */
            margin-right: 10px;
        }
    </style>
</head>
<body>

<div class="modal fade" id="videoModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header border-0 pb-0">
                <h6 class="modal-title text-white" id="videoTitle" title="">è§†é¢‘é¢„è§ˆ</h6>
                <button type="button" class="close text-white" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body p-2">
                <video id="mainPlayer" controls playsinline webkit-playsinline muted>
                    <source id="videoSource" src="" type="video/mp4">
                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ HTML5 æ’­æ”¾
                </video>
            </div>
        </div>
    </div>
</div>

<div class="container main-container">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="font-weight-bold text-dark m-0">ğŸš€yt_dlp_web</h3>
        <div class="btn-group shadow-sm" role="group">
            <button class="btn btn-outline-primary btn-sm px-3" data-toggle="modal" data-target="#configModal" style="border-top-left-radius: 10px; border-bottom-left-radius: 10px;">
                âš™ï¸
            </button>
            <button class="btn btn-outline-info btn-sm px-3" data-toggle="modal" data-target="#cookieModal">
                ğŸª
            </button>
<button class="btn btn-outline-info btn-sm px-3" onclick="showSN()">
    ğŸ“„
</button>

            <a href="/logout" class="btn btn-danger btn-sm px-3" style="border-top-right-radius: 10px; border-bottom-right-radius: 10px; display: flex; align-items: center;">
                é€€å‡º
            </a>
        </div>
    </div>

<div class="input-card">
    <div class="input-group">
        <select id="cookie_select_download" class="form-control" style="max-width: 120px; height: 55px; border: 2px solid #eee; border-right: none; border-radius: 12px 0 0 12px;">
            <option value="auto" selected>âœ¨ è‡ªåŠ¨è¯†åˆ«</option>
            <option value="default">é»˜è®¤åº“</option>
            <option value="youtube">YouTube</option>
            <option value="x">X / Twitter</option>
            <option value="vimeo">Vimeo</option>
            <option value="instagram">Instagram</option>
        </select>
        
        <input type="text" id="video_url" class="form-control url-input" placeholder="è¾“å…¥é“¾æ¥..." style="border-radius: 0;">
        
        <div class="input-group-append">
            <button class="btn btn-danger btn-download text-white" onclick="startDownload()">å¼€å§‹ä¸‹è½½</button>
        </div>
    </div>
</div>

    <div id="progress_section" class="status-card p-4 d-none">
<div class="d-flex justify-content-between align-items-center mb-2">
        <h6 id="current_filename" class="text-truncate font-weight-bold" style="max-width: 60%;">è§£æä¸­...</h6>
        <div>
            <span id="current_percent" class="badge badge-danger">0%</span>
        </div>
    </div>
        <div class="progress mb-3" style="height: 20px; border-radius: 10px;">
            <div id="main_pb" class="progress-bar progress-bar-striped progress-bar-animated bg-danger" style="width: 0%"></div>
        </div>
        <div class="row text-center small text-muted">
            <div class="col-6">é€Ÿåº¦: <span id="current_speed">--</span></div>
            <div class="col-6">å‰©ä½™: <span id="current_eta">--</span></div>
        </div>
    </div>

    <div class="status-card p-3">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="small font-weight-bold text-muted">åå°æ—¥å¿—</span>
            <button class="btn btn-sm btn-outline-secondary ml-2" onclick="document.getElementById('log-container').innerHTML=''" style="font-size: 11px; padding: 2px 8px; border-radius: 8px;">æ¸…ç©º</button>
            <button class="btn btn-sm btn-outline-secondary ml-2" onclick="handleStop()" style="font-size: 11px; padding: 2px 8px; border-radius: 8px;">
                åœæ­¢å¹¶åˆ·æ–°
            </button>

        </div>
        <div id="log-container">
            <div class="log-entry">ğŸŸ¢ ç³»ç»Ÿå·²å°±ç»ªã€‚</div>
        </div>
    </div>

<h5 class="font-weight-bold mb-3 mt-4">å·²å®Œæˆä»»åŠ¡</h5>
<div id="file_list">
    {% for file in files %}
    <div class="file-item" style="transition: all 0.2s; border: 1px solid transparent;" onmouseover="this.style.borderColor='#cc0000'" onmouseout="this.style.borderColor='transparent'">
        <div class="text-truncate mr-3" style="flex: 1; cursor: pointer;">
            <div onclick="previewVideo('{{ file.name }}')" title="{{ file.name }}">
                <span class="text-dark font-weight-bold">
                    ğŸ¬
                    {% if file.name|length > 35 %}
                        {{ file.name[:30] }}...{{ file.name[-7:] }}
                    {% else %}
                        {{ file.name }}
                    {% endif %}
                </span>
                <div class="mt-1">
                    <span class="badge badge-light text-muted" style="font-weight: normal;">
                        <i class="fa fa-hdd-o"></i> {{ file.size }}
                    </span>
                    <span class="badge badge-light text-muted ml-2" style="font-weight: normal;">
                        <i class="fa fa-clock-o"></i> {{ file.time }}
                    </span>
                </div>
            </div>
        </div>
        <div class="d-flex align-items-center">
            <a href="/get_file/{{ file.name }}?download=1" class="btn btn-sm btn-success mr-2 px-3 shadow-sm">ä¸‹è½½</a>
            <form action="/delete/{{ file.name }}" method="POST" onsubmit="return confirm('ç¡®å®šä»ç£ç›˜åˆ é™¤æ­¤è§†é¢‘å—ï¼Ÿ')">
                <button type="submit" class="btn btn-sm btn-outline-danger shadow-sm">åˆ é™¤</button>
            </form>
        </div>
    </div>
    {% endfor %}
</div>

<div class="modal fade" id="configModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <form action="/update_proxy" method="POST" class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">ä»£ç†é…ç½®</h5>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>ä»£ç†åœ°å€</label>
                    <input type="text" name="proxy_url" class="form-control" value="{{ config.proxy_url }}">
                </div>
                <div class="custom-control custom-switch">
                    <input type="checkbox" class="custom-control-input" id="proxySwitch" name="proxy_enabled" {% if config.proxy_enabled %}checked{% endif %}>
                    <label class="custom-control-label" for="proxySwitch">å¼€å¯å…¨å±€ä»£ç†</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary btn-block">ä¿å­˜ä¿®æ”¹</button>
            </div>
        </form>
    </div>
</div>

<div class="modal fade" id="cookieModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <form action="/update_cookies" method="POST">
                <div class="modal-header">
                    <h5 class="modal-title">Cookies åº“ç®¡ç†</h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group mb-3 p-2" style="background: #f0f7ff; border-radius: 8px;">
<div class="form-group">
    <label class="small font-weight-bold text-primary">ç›®æ ‡å­˜å‚¨åº“ï¼š</label>
    <select name="cookie_target" id="cookie_target_select" class="form-control form-control-sm" onchange="loadCookieFile(this.value)">
        <option value="default">é»˜è®¤ä¸»åº“ (cookies.txt)</option>
        <option value="youtube">YouTube åº“ (cookies_youtube.txt)</option>
        <option value="x">X / Twitter åº“ (cookies_x.txt)</option>
        <option value="vimeo">Vimeo åº“ (cookies_vimeo.txt)</option>
        <option value="instagram">Instagram åº“ (cookies_instagram.txt)</option>
    </select>
    
    <div class="mt-2 mb-1 d-flex justify-content-between">
        <span class="small text-muted">å½“å‰ç¼–è¾‘æ–‡ä»¶å†…å®¹ï¼š</span>
        <span id="cookie_status_tag" class="badge badge-info">ç­‰å¾…åŠ è½½...</span>
    </div>

    <textarea name="cookies_data" id="cookies_data_area" class="form-control" rows="10" placeholder="åœ¨æ­¤ç²˜è´´ Netscape æ ¼å¼å†…å®¹..."></textarea>
</div>



                    </div>
                <div class="modal-footer d-flex justify-content-between">
                    <button type="button" class="btn btn-outline-danger" onclick="deleteCookies()">æ¸…ç©ºé»˜è®¤æ–‡ä»¶</button>
                    <div>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">å–æ¶ˆ</button>
                        <button type="submit" class="btn btn-success px-5">ä¿å­˜è‡³é€‰å®šåº“</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
</div></div>
<div class="modal fade" id="snModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" style="border-radius: 15px;">
            <div class="modal-header border-0">
                <h5 class="modal-title font-weight-bold">ğŸ“– ä½¿ç”¨è¯´æ˜</h5>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <pre id="sn_content" style="white-space: pre-wrap; word-wrap: break-word; background: #f8f9fa; padding: 15px; border-radius: 10px; min-height: 100px;"></pre>
            </div>
        </div>
    </div>
</div>


<script src="../static/js/jquery.slim.min.js"></script>
<script src="../static/js/bootstrap.bundle.min.js"></script>

<script src="/static/js/socket.io.min.js"></script>
<script>
(function() {
    var socket = io();
    var isSubmitting = false;

    // --- 1. å‘èµ·ä¸‹è½½ä»»åŠ¡ (å¼‚æ­¥ Fetch ä¼˜åŒ–ï¼Œé˜²æ­¢é¡µé¢é‡ç½®) ---
    window.startDownload = function() {
        if (isSubmitting) return;

        var urlInput = document.getElementById('video_url');
        var cookieSelect = document.getElementById('cookie_select_download'); // è·å–é€‰æ‹©çš„åº“
        if (!urlInput) return;
        
        var url = urlInput.value.trim();
        if (!url) return alert('è¯·è¾“å…¥é“¾æ¥');

        isSubmitting = true;
        var btn = document.querySelector('button[onclick="startDownload()"]');
        if (btn) {
            btn.disabled = true;
            btn.innerHTML = '<span class="spinner-border spinner-border-sm"></span> æäº¤ä¸­...';
        }

        // å¼‚æ­¥æäº¤ï¼Œåœ°å€æ ä¸ä¼šå˜åŒ–
        fetch('/start_download', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            //body: JSON.stringify({ url: url })
            body: JSON.stringify({ 
                url: url,
                cookie_key: cookieSelect.value // å°†åº“åç§°å‘é€ç»™åç«¯
            })

        })
        .then(response => {
            if (!response.ok) throw new Error('ç½‘ç»œè¯·æ±‚å¤±è´¥');
            return response.json();
        })
        .then(data => {
            if (data.status === 'success') {
                urlInput.value = '';
                console.log("ä»»åŠ¡åå°æŒ‚è½½æˆåŠŸ");
            } else {
                alert("æäº¤å¤±è´¥: " + data.message);
                resetSubmitButton();
            }
        })
        .catch(err => {
            alert("ç³»ç»Ÿè¿æ¥è¶…æ—¶ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡");
            resetSubmitButton();
        });
    };

    // --- 2. åˆ é™¤ Cookies ---
    window.deleteCookies = function() {
        if(confirm('ç¡®å®šæ¸…ç©ºæœåŠ¡å™¨ä¸Šçš„ cookies.txt å—ï¼Ÿ')) {
            var form = document.getElementById('realDelCookieForm');
            if(form) form.submit();
        }
    };

    // --- 3. ç›‘å¬ä¸‹è½½è¿›åº¦ ---
    socket.on('update_progress', function(data) {
        var section = document.getElementById('progress_section');
        if (section) section.classList.remove('d-none');
        
        var el_file = document.getElementById('current_filename');
        var el_perc = document.getElementById('current_percent');
        var el_pb = document.getElementById('main_pb');
        var el_speed = document.getElementById('current_speed');
        var el_eta = document.getElementById('current_eta');

        if(el_file) el_file.innerText = data.filename;
        if(el_perc) el_perc.innerText = data.percent;
        if(el_pb) el_pb.style.width = data.percent;
        if(el_speed) el_speed.innerText = data.speed;
        if(el_eta) el_eta.innerText = data.eta;
    });

    // --- 4. æ—¥å¿—ç›‘å¬ä¸è‡ªåŠ¨æ»šåŠ¨ ---
    socket.on('log_message', function(data) {
        var container = document.getElementById('log-container');
        if (!container) return;

        var div = document.createElement('div');
        div.className = 'log-entry';
        
        if (data.msg.indexOf('âŒ') !== -1) {
            div.style.color = '#ff4d4d';
            resetSubmitButton(); 
        } else if (data.msg.indexOf('âœ…') !== -1) {
            div.style.color = '#28a745';
        } else if (data.msg.indexOf('âš ï¸') !== -1) {
            div.style.color = '#ffc107';
        }

        div.innerText = data.msg;
        container.appendChild(div);
        container.scrollTop = container.scrollHeight;
    });

    // --- 5. ä¸‹è½½å®Œæˆåˆ·æ–° ---
    socket.on('download_complete', function() {
        resetSubmitButton();
        setTimeout(function() { location.reload(); }, 2000);
    });

    function resetSubmitButton() {
        isSubmitting = false;
        var btn = document.querySelector('button[onclick="startDownload()"]');
        if (btn) {
            btn.disabled = false;
            btn.innerText = 'å¼€å§‹ä¸‹è½½';
        }
    }

    // --- 6. è§†é¢‘é¢„è§ˆé€»è¾‘ (è§£å†³æ’­æ”¾æ‹¦æˆª) ---
    window.previewVideo = function(filename) {
        var player = document.getElementById('mainPlayer');
        if (!player) return;

        // åˆå§‹é™éŸ³ç¡®ä¿æ’­æ”¾é€šè¿‡
        player.muted = true;
        player.pause(); 
        
        var videoUrl = '/get_file/' + encodeURIComponent(filename);
        var source = document.getElementById('videoSource');
        var title = document.getElementById('videoTitle');

        if(title) {
            title.innerText = filename;
            title.setAttribute('title', filename);
        }
        
        if(source) source.src = videoUrl;
        player.load(); 

        $('#videoModal').modal('show');
        
        // ç­‰å¾…å¼¹çª—å®Œæˆåæ’­æ”¾ï¼Œç»•è¿‡æ‹¦æˆª
        $('#videoModal').one('shown.bs.modal', function () {
            var playPromise = player.play();
            if (playPromise !== undefined) {
                playPromise.catch(function(e) { console.log("æ’­æ”¾ä»å—é™"); });
            }
        });
    };

    // --- 7. æ’­æ”¾å™¨å…³é—­é‡Šæ”¾ ---
    $(document).ready(function() {
        $('#videoModal').on('hidden.bs.modal', function () {
            var player = document.getElementById('mainPlayer');
            if(player) {
                player.pause();          
                player.src = "";         
                player.load();
                player.muted = true;
            }
        });
    });

})();
// å¤„ç†åœæ­¢é€»è¾‘
window.handleStop = function() {
    if (!confirm('ç¡®å®šè¦åœæ­¢å½“å‰ä¸‹è½½å—ï¼Ÿ')) return;

    // ç«‹å³ç¦ç”¨æŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»
    const stopBtn = event.target;
    stopBtn.disabled = true;
    stopBtn.innerText = 'æ­£åœ¨åœæ­¢...';

    fetch('/stop_download', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' }
    })
    .then(response => {
        if (response.ok) {
            // åœé¡¿ 0.5 ç§’ç»™åç«¯ä¸€ç‚¹å“åº”æ—¶é—´ï¼Œç„¶ååˆ·æ–°é¡µé¢
            setTimeout(() => {
                location.reload();
            }, 500);
        }
    })
    .catch(err => {
        console.error("åœæ­¢è¯·æ±‚å¤±è´¥", err);
        location.reload(); // å¤±è´¥ä¹Ÿåˆ·æ–°ï¼Œä»¥é‡ç½® UI
    });
};
// åˆ‡æ¢å¹¶åŠ è½½æ–‡ä»¶å†…å®¹
function loadCookieFile(target) {
    const textArea = document.getElementById('cookies_data_area');
    const statusTag = document.getElementById('cookie_status_tag');
    const selectElement = document.getElementById('cookie_target_select');
    
    // è·å–é€‰ä¸­é¡¹çš„æ–‡å­—å†…å®¹ï¼ˆä¾‹å¦‚ "YouTube åº“"ï¼‰
    const selectedText = selectElement.options[selectElement.selectedIndex].text;

    // UI åé¦ˆ
    statusTag.innerText = "æ­£åœ¨è¯»å– " + target + "...";
    statusTag.className = "badge badge-warning";
    textArea.disabled = true;

    fetch('/get_cookie_content/' + target)
        .then(response => response.text())
        .then(data => {
            textArea.value = data;
            textArea.disabled = false;
            statusTag.innerText = "å·²åŠ è½½ï¼š" + selectedText;
            statusTag.className = "badge badge-success";
        })
        .catch(err => {
            textArea.value = "";
            textArea.disabled = false;
            statusTag.innerText = "è¯»å–å¤±è´¥";
            statusTag.className = "badge badge-danger";
        });
}

$(document).ready(function() {
    // --- Cookie æ¨¡æ€æ¡†é€»è¾‘ ---
    $('#cookieModal').on('shown.bs.modal', function () {
        const currentTarget = $('#cookie_target_select').val();
        loadCookieFile(currentTarget);
    });

    // --- è¯´æ˜æ¨¡æ€æ¡†é€»è¾‘ ---
    // ç›‘å¬æ˜¾ç¤ºäº‹ä»¶ï¼šåªè´Ÿè´£åŠ è½½å†…å®¹ï¼Œä¸è¦å†è°ƒç”¨ .modal('show')
    $('#snModal').on('show.bs.modal', function () {
        loadSNContent(); // å¼¹çª—å¼€å§‹æ˜¾ç¤ºæ—¶ç«‹å³åŠ è½½å†…å®¹
    });
});

// 1. æŒ‰é’®ç‚¹å‡»ç›´æ¥è°ƒèµ·å¼¹çª—
function showSN() {
    $('#snModal').modal('show');
}

// 2. æ ¸å¿ƒåŠ è½½å‡½æ•°ï¼šåªè´Ÿè´£å¡«å…¥å†…å®¹
function loadSNContent() {
    const $content = $('#sn_content');
    $content.text('æ­£åœ¨åŠ è½½è¯´æ˜æ–‡æ¡£...');
    
    fetch('/get_sn')
        .then(response => response.text())
        .then(data => {
            $content.text(data);
        })
        .catch(err => {
            $content.text('åŠ è½½å¤±è´¥ï¼š' + err);
        });
}
</script>
</body>
</html>
